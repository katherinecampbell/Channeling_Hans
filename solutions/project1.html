<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script type="text/javascript" src="./d3/d3.v4.js" charset="utf-8"></script>
<!-- Example based on http://bl.ocks.org/mbostock/3887118 -->
<!-- Tooltip example from http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html -->
<style type="text/css">
		.axis path,
		.axis line {
		    fill: none;
		    stroke: black;
		    shape-rendering: crispEdges;
		}
		
		.axis text {
		    font-family: sans-serif;
		    font-size: 11px;
		}	
	</style>
    </head>
<body>
    
<script>
var margin = {top: 20, right: 20, bottom: 30, left: 40};
var outer_width = 1000;
var outer_height = 1000;
var svg_width = outer_width - margin.left - margin.right;
var svg_height = outer_height - margin.top - margin.bottom;

   
// add canvas to page
var svg = d3.select("body").append("svg")
    .attr("width", svg_width + margin.left + margin.right)
    .attr("height", svg_height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");    
    
    
function generateVis(){    
    //set up x
    var xScale = d3.scaleLinear()
        .range([0, svg_width], 0.1) //value of display
        .domain([0, d3.max(dataset, function(d){return +d.GDP;}) ])
   
    var xAxis =     d3.axisBottom().scale(xScale).tickFormat(function(d){ return d.x;});

    // setup y
    var yScale = d3.scaleLinear()
        .range([svg_height, 0])
        .domain([function(d) { return d.lifeExpectancy; }]); // value to display
    
    var yAxis = d3.axisLeft().scale(yScale);

    // call the x-axis
			svg.append("g")
				.attr("class", "axis")
				.attr("id", "x-axis")
				.attr("transform", "translate(0," + svg_height + ")");   
    
    // Call the y axis
			svg.append("g")
				.attr("class", "axis")
				.attr("id", "y-axis")
				.call(yAxis);
					
     
    //make dots
    svg.selectAll(".dot")
      .data(dataset)
    .enter().append("circle")
      .attr("class", "dot")
      .attr("r", 5)
      .attr("cx", function (d,i){return xScale(d.GDP)})
      .attr("cy", function(d,i){return yScale(d.LifeExp)})
      .style("fill", "Blue") 

}

// load data
d3.csv("data/Gapminder_small.csv", function(error, data) {

// handle any data loading errors
				if(error){
					console.log("Something went wrong");
					console.log(error);
				}
                else{
					console.log("Data Loaded");
					
					// Assign  the data object loaded to the global dataset variable
					dataset = data;
					

					// Generate the visualisation
					generateVis();
                }
    

});

 
</script>
</body>
</html>